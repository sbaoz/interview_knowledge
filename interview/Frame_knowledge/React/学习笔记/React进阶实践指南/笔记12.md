# 优化-渲渲染调优  

### 懒加载和异步渲染  

- 异步渲染  
  Suspense是React提出的一种同步的代码来实现异步操作的方案 Suspense让组件等待异步操作 异步请求结束后再进行组件的渲染  
  目前这个功能还在试验阶段  
  - Suspense的用法  
    Suspense是组件 有一个fallback属性 用来代替当Suspense处于loading状态下渲染的内容  
    Suspense的children就是异步组件 多个异步组件可以用Suspense嵌套使用  

- 动态加载（懒加载）  
  Suspense配合React.lazy可以实现动态加载功能  
  React.lazy接受一个函数 这个函数需要动态调用import() 必须返回一个Promise 改Promise需要resolve一个default export的React组件  
  用React.lazy动态引入的组件 配合Suspense实现动态加载组件效果 这样利于代码分割 不会让初始化的时候加载大量的文件  
  
  - React.lazy和Suspense实现动态加载原理  
    Suspense原理  
    Suspense在执行内部可以通过try{}catch{}方式捕获异常 这个异常通常是一个Promise  
    可以在这个Promise中进行数据请求 Suspense内部会处理这个Promise  
    Promise结束后 Suspense会再一次重新render把数据渲染出来 达到异步渲染的效果
    lazy原理  
    lazy内部模拟一个PromiseA规范场景 用Promise模拟量一个请求数据的过程 但是请求的结果不是数据 而是一个组件  
    
