# 优化-细节处理  

### React中防抖和节流
- 防抖  
  防抖函数一般用于表单搜索 点击事件等场景 目的就是为了防止短时间内多次触发事件  
- 节流  
  节流函数一般为了降低函数执行的频率 比如滚动条滚动  

### antd按需引入  
使用antd UI库的时候 可以配置.babelrc实现按需引入  
安装babel-plugin-import  
```json
["import", {
    "libraryName":
    "antd",
    "libraryDirectory": "es",
    "style": true
}]
```

### React动画  
React写动画是一个比较棘手的问题 高频率的setState会给应用性能带来挑战  
总结三种React使用动画的方式已经他们的权重  
1. 首选动态添加类名  
   通过transition animation实现动画然后写在class类名里面 通过动态切换类名 达到动画的目的 这种方式既不需要频繁setState 也不需要改变DOM  
2. 其次操纵原生DOM  
   如果第一种方式不能满足要求的话 或者必须用js实现复杂的动画效果 那么可以获取原生DOM 然后单独操作DOM实现动画功能 这样就避免了setState改变带来React Fiber深度调和渲染的影响  
3. 再者setState + css3  
   如果1和2都不能满足要求 一定要使用setState实时改变DOM元素状态的话 那么尽量采用css3 css3开启硬件加速 使GPU发挥功能 从而提升性能  

### 及时清除定时器/延时器/监听器  
如果在React项目中 用到了定时器、延时器和事件监听 注意要在对应的生命周期清除他们 不然会造成内部泄漏的情况  
类组件在componentWillUnmount生命周期清除延时器和事件监听  
函数组件在useEffect或者useLayoutEffect第一个参数create的返回函数中 做一些清除定时器、延时器的操作

### 合理使用state  
如果视图更新不依赖于当前state 那么就可以考虑不放在state中  
类组件中可以直接把变量绑定在this上 函数组件因为不存在实例 但是有hooks 可以通过useRef实现同样的效果